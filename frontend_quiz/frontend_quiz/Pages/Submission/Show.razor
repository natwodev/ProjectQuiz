@page "/submission/view/{id:int}"
@using frontend_quiz.DTOs
@using frontend_quiz.Services
@inject SubmissionService Submission
@inject AuthService AuthService
@inject NavigationManager NavigationManager
@inject QuestionService questionService

@if (!_isAuthenticated)
{
    <div class="alert alert-warning">
        Vui lòng <a href="/login">đăng nhập</a> để xem nội dung bài kiểm tra.
    </div>
}
else if (!_isStudent)
{
    <div class="alert alert-danger">
        Bạn không có quyền truy cập trang này.
    </div>
}
else
{
    if (_submission == null)
    {
        <p>Đang tải dữ liệu...</p>
    }
    else
    {

    }
}

@code {
    [Parameter] public int id { get; set; }

    private SubmissionDto? _submission;
    private bool _isStudent;
    private bool _isAuthenticated;

    protected override async Task OnInitializedAsync()
    {
        _isAuthenticated = await AuthService.IsAuthenticated();

        if (!_isAuthenticated) return;

        _isStudent = await AuthService.IsStudent();

        if (!_isStudent)
        {
            NavigationManager.NavigateTo("/");
            return;
        }

        _submission = await Submission.GetSubmissionByIdAsync(id);
    }
}